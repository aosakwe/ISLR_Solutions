#Private vs. Out-of-state tuition boxplot
college
#Private vs. Out-of-state tuition boxplot
plot(college$Private,college$Outstate) #, xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
#Private vs. Out-of-state tuition boxplot
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
#Private vs. Out-of-state tuition boxplot
plot(college$Private)
#Private vs. Out-of-state tuition boxplot
plot(x = college$Private)
#Private vs. Out-of-state tuition boxplot
plot(college$Outstate)
college <- read.csv("College.csv")
rownames(college) <- college[,1]
college <- college[,-1]
college[,1] <- as.factor(college[,1])
# For Private Column: private -> 2, public -> 1
head(college)
summary(college)
#Scatterplot matrix of the first ten variables
tmp <- college
tmp[,1] <- as.numeric(college[,1])
pairs(tmp[,1:10])
#Private vs. Out-of-state tuition boxplot
plot(college$Outstate)
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
college$Elite <- ifelse(college$Top10perc > 50, "Yes", "No")
summary(college)
college$Elite <- as.factor(ifelse(college$Top10perc > 50, "Yes", "No"))
summary(college)
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 4, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$perc.alumni, col = 5, ylab = "Counts", xlab = "% of Alumni that donate" )
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$perc.alumni, col = 8, ylab = "Counts", xlab = "% of Alumni that donate" )
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
summary(college)
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
college[college$PhD > 100,]
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100])
rownames(college)[college$Grad.Rate > 100]
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(c(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100]))
college <- read.csv("datasets/College.csv")
rownames(college) <- college[,1]
college <- college[,-1]
college[,1] <- as.factor(college[,1])
# For Private Column: private -> 2, public -> 1
head(college)
summary(college)
#Scatterplot matrix of the first ten variables
tmp <- college
tmp[,1] <- as.numeric(college[,1])
pairs(tmp[,1:10])
#Private vs. Out-of-state tuition boxplot
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
college$Elite <- as.factor(ifelse(college$Top10perc > 50, "Yes", "No"))
summary(college)
#Histograms
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(c(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100]))
#The two erroneous values concern Texas A&M and Cazenovia College
car <- read.csv("datasets/Auto.csv")
head(car)
length(is.na(car))
fix(car)
car[car == "?"]
car[is.na(car)]
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
car
?na.omit
colnames(car)
head(car)
?sapply
apply(cars[,1:6],2,range)
apply(car[,1:6],2,range)
dim(car)
range(car$mpg)
apply(car[,1:6],2,max - min)
apply(car[,1:6],2,range)
sapply(car[,1:6],range)
sapply(car[,1:6],mean)
sapply(car[,1:6],sd)
subset_car <- car[-c(10:85),]
subset_car <- car[-c(10:85),]
sapply(subset_car[,1:6],range)
sapply(subset_car[,1:6],mean)
sapply(subset_car[,1:6],sd)
subset_car <- car[-c(10:85),]
sapply(subset_car[,1:6],range)
sapply(subset_car[,1:6],mean)
sapply(subset_car[,1:6],sd)
subset_car
sapply(subset_car[,1:6],range)
sapply(subset_car[,1:6],mean)
sapply(subset_car[,1:6],sd)
sapply(car[,1:6],mean)
head(car)
sapply(car[,c(1:3,5,6)],range)
sapply(car[,c(1:3,5,6)],mean)
sapply(car[,c(1:3,5,6)],sd)
subset_car <- car[-c(10:85),c(1:3,5,6)]
sapply(subset_car,range)
sapply(subset_car,mean)
sapply(subset_car,sd)
#Exploration
car[is.character(car)] <- as.factor(car[is.character(car)])
car
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#Exploration
car$horsepower <- as.factor(car$horsepower)
pairs(car)
pairs(car[,1:8])
pairs(car[,1:7])
car[is.character(car)]
head(car)
car$name <- as.factor(car$name)
pairs(car)
##Observations
#Can see a strong positive correlation between displacement and weight
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show trends resembling two-step functions (bimodal distribution of values for some of the traits?)
hist(car$horsepower)
##Observations
#Can see a strong positive correlation between displacement and weight
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show trends resembling two-step functions (bimodal distribution of values for some of the traits?)
hist(as.numeric(car$horsepower))
##Observations
#Can see a strong positive correlation between displacement and weight
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show trends resembling two-step functions (bimodal distribution of values for some of the traits?)
hist(as.numeric(car$horsepower), xlab = "Horsepower", ylab = "Count", main = "Horsepower Histogram")
pairs(car)
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
``` { r Q10, echo = TRUE}
boston <- read.csv("Boston.csv")
``` { r Q10, echo = TRUE}
library(MASS)
``` { r Q10, echo = TRUE}
library(MASS)
Boston
```
``` { r Q10, echo = TRUE}
library(MASS)
?Boston
```
``` { r Q10, echo = TRUE}
library(MASS)
dim(Boston)
``` { r Q10, echo = TRUE}
library(MASS)
dim(Boston)
dim(car)
``` {r Q9, echo = TRUE}
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#mpg, cylinders, displacement,weight and acceleration are quantitative traits whereas year, origin and name and horsepower are categorical
sapply()
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#mpg, cylinders, displacement,weight and acceleration are quantitative traits whereas year, origin and name and horsepower are categorical
dim(car)
sapply(car[,c(1:3,5,6)],range)
sapply(car[,c(1:3,5,6)],mean)
sapply(car[,c(1:3,5,6)],sd)
subset_car <- car[-c(10:85),c(1:3,5,6)]
sapply(subset_car,range)
sapply(subset_car,mean)
sapply(subset_car,sd)
#Exploration
#car$horsepower <- as.factor(car$horsepower)
car$name <- as.factor(car$name)
pairs(car)
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#mpg, cylinders, displacement,weight and acceleration are quantitative traits whereas year, origin and name and horsepower are categorical
dim(car)
sapply(car[,c(1:3,5,6)],range)
sapply(car[,c(1:3,5,6)],mean)
sapply(car[,c(1:3,5,6)],sd)
subset_car <- car[-c(10:85),c(1:3,5,6)]
sapply(subset_car,range)
sapply(subset_car,mean)
sapply(subset_car,sd)
#Exploration
car$horsepower <- as.numeric(car$horsepower)
car$name <- as.factor(car$name)
pairs(car)
##Observations
#Can see a strong positive correlation between displacement and weight
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show trends resembling two-step functions (bimodal distribution of values for some of the traits?)
hist(car$horsepower, xlab = "Horsepower", ylab = "Count", main = "Horsepower Histogram")
#Many of the two-step function-like trends were in plots with horsepower measurements. Sure enough, the histogram show a somewhat bimodal distribution between low and high horsepower
#Based of the scatterplots, displacement and weight may be the best predictors for mpg as they display somewhat linear correlations with mpg.
``` { r Q10, echo = TRUE}
library(MASS)
dim(Boston)
#Dataset contains 506 rows and 14 observations
``` { r Q10, echo = TRUE}
library(MASS)
dim(Boston)
#Dataset contains 506 rows and 14 observations
head(Boston)
```
#Dataset contains 506 rows and 14 observations
head(Boston)
pairs(Boston)
nrow(Boston[Boston$chas == 1,])
median(Boston$ptratio)
rownames(Boston[Boston$medv == min(Boston$medv),])
rownames(Boston[min(Boston$medv),])
rownames(Boston[Boston$medv == min(Boston$medv),])
Boston
min(Boston$medv)
min(Boston$medv)
rownames(Boston[Boston$medv == min(Boston$medv),])
Boston$medv
Boston[min(Boston$medv)]
Boston[min(Boston$medv),]
nrow(Boston[Boston$rm > 7,])
nrow(Boston[Boston$rm > 8,])
summary(Boston[Boston$rm > 8,])
summary(Boston)
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate  and ptratio
summary(Boston)
summary(Boston[Boston$rm > 8,])
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate  and ptratio
summary(Boston)
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate  and ptratio
summary(Boston)
include_graphics("WhatsApp Image 2022-01-07 at 09.49.16.jpeg")
knittr::include_graphics("WhatsApp Image 2022-01-07 at 09.49.16.jpeg")
knitr::include_graphics("WhatsApp Image 2022-01-07 at 09.49.16.jpeg")
knitr::include_graphics("WhatsApp Image 2022-01-07 at 09.49.16.jpeg")
college <- read.csv("datasets/College.csv")
rownames(college) <- college[,1]
college <- college[,-1]
college[,1] <- as.factor(college[,1])
# For Private Column: private -> 2, public -> 1
head(college)
summary(college)
#Scatterplot matrix of the first ten variables
tmp <- college
tmp[,1] <- as.numeric(college[,1])
pairs(tmp[,1:10])
#Private vs. Out-of-state tuition boxplot
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
college$Elite <- as.factor(ifelse(college$Top10perc > 50, "Yes", "No"))
summary(college)
#Histograms
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(c(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100]))
#The two erroneous values concern Texas A&M and Cazenovia College
car <- read.csv("datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#mpg, cylinders, displacement,weight and acceleration are quantitative traits whereas year, origin and name and horsepower are categorical
dim(car)
sapply(car[,c(1:3,5,6)],range)
sapply(car[,c(1:3,5,6)],mean)
sapply(car[,c(1:3,5,6)],sd)
subset_car <- car[-c(10:85),c(1:3,5,6)]
sapply(subset_car,range)
sapply(subset_car,mean)
sapply(subset_car,sd)
#Exploration
car$horsepower <- as.numeric(car$horsepower)
car$name <- as.factor(car$name)
pairs(car)
##Observations
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show linear trends when displacement, horsepower, or weight are one or both of the variables
#Based of the scatterplots, displacement, horsepower and weight may be the best predictors for mpg as they display linear correlations with mpg.
library(MASS)
dim(Boston)
#Dataset contains 506 rows and 14 observations
head(Boston)
pairs(Boston)
nrow(Boston[Boston$chas == 1,])
median(Boston$ptratio)
rownames(Boston[Boston$medv == min(Boston$medv),])
nrow(Boston[Boston$rm > 7,])
nrow(Boston[Boston$rm > 8,])
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate, and a lower ptratio and lstat
#The medv is also double that of the entire city
summary(Boston)
library(MASS)
dim(Boston)
#Dataset contains 506 rows and 14 observations
head(Boston)
pairs(Boston)
nrow(Boston[Boston$chas == 1,])
median(Boston$ptratio)
rownames(Boston[Boston$medv == min(Boston$medv),])
nrow(Boston[Boston$rm > 7,])
nrow(Boston[Boston$rm > 8,])
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate, and a lower ptratio and lstat
#The medv is also double that of the entire city
setwd("C:/Users/User/OneDrive - McGill University/PhD-1/Practice/ISLR_Practice/Ch2")
knitr::include_graphics("plot.jpeg")
college <- read.csv("../datasets/College.csv")
rownames(college) <- college[,1]
college <- college[,-1]
college[,1] <- as.factor(college[,1])
# For Private Column: private -> 2, public -> 1
head(college)
summary(college)
#Scatterplot matrix of the first ten variables
tmp <- college
tmp[,1] <- as.numeric(college[,1])
pairs(tmp[,1:10])
#Private vs. Out-of-state tuition boxplot
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
college$Elite <- as.factor(ifelse(college$Top10perc > 50, "Yes", "No"))
summary(college)
#Histograms
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(c(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100]))
#The two erroneous values concern Texas A&M and Cazenovia College
knitr::include_graphics("plot.jpeg")
college <- read.csv("../datasets/College.csv")
rownames(college) <- college[,1]
college <- college[,-1]
college[,1] <- as.factor(college[,1])
# For Private Column: private -> 2, public -> 1
head(college)
summary(college)
#Scatterplot matrix of the first ten variables
tmp <- college
tmp[,1] <- as.numeric(college[,1])
pairs(tmp[,1:10])
#Private vs. Out-of-state tuition boxplot
plot( x = college$Private, y = college$Outstate,xlab = "Private Institution", ylab = "Out-of-State Tuition (USD)", main = "Out-of-State Tuition Boxplot")
college$Elite <- as.factor(ifelse(college$Top10perc > 50, "Yes", "No"))
summary(college)
#Histograms
par(mfrow= c(2,2))
hist(college$Apps,col = 2, ylab = "Counts", xlab = "Number of Applicants" )
hist(college$PhD, col = 3, ylab = "Counts", xlab = "% of Faculty with PhDs" )
hist(college$Grad.Rate, col = 5, ylab = "Counts", xlab = "Graduation Rate" )
hist(college$F.Undergrad, col = 8, ylab = "Counts", xlab = "Number of Full-Time Undergrads" )
##Observations
#skewed distribution of PhD holders in faculty positions
#Normal distribution for graduation rates
#Reviewing summary statistics shows anomalies in Graduation rate and PhD variables where there are values above 100%
unique(c(rownames(college)[college$PhD > 100],rownames(college)[college$Grad.Rate > 100]))
#The two erroneous values concern Texas A&M and Cazenovia College
car <- read.csv("../datasets/Auto.csv")
car[car == "?"] <- NA
car <- na.omit(car)
head(car)
#mpg, cylinders, displacement,weight, horsepower and acceleration are quantitative traits whereas year, origin and name are categorical
dim(car)
sapply(car[,c(1:3,5,6)],range)
sapply(car[,c(1:3,5,6)],mean)
sapply(car[,c(1:3,5,6)],sd)
subset_car <- car[-c(10:85),c(1:3,5,6)]
sapply(subset_car,range)
sapply(subset_car,mean)
sapply(subset_car,sd)
#Exploration
car$horsepower <- as.numeric(car$horsepower)
car$name <- as.factor(car$name)
pairs(car)
##Observations
# The categorical traits show little correlation with the quantitative traits
#Many of the correlations between the quantitative traits show linear trends when displacement, horsepower, or weight are one or both of the variables
#Based of the scatterplots, displacement, horsepower and weight may be the best predictors for mpg as they display linear correlations with mpg.
library(MASS)
dim(Boston)
#Dataset contains 506 rows and 14 observations
head(Boston)
pairs(Boston)
nrow(Boston[Boston$chas == 1,])
median(Boston$ptratio)
rownames(Boston[Boston$medv == min(Boston$medv),])
nrow(Boston[Boston$rm > 7,])
nrow(Boston[Boston$rm > 8,])
summary(Boston[Boston$rm > 8,])
#Suburbs with more than 8 rooms per dwelling have a very low crime rate, and a lower ptratio and lstat
#The medv is also double that of the entire city
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/User/OneDrive - McGill University/PhD-1/QLS_Rotation_1/new_analysis220105")
load("C:/Users/User/OneDrive - McGill University/PhD-1/QLS_Rotation_1/new_analysis220105/.RData")
library(scater)
library(scran)
library(SingleCellExperiment)
library(HDF5Array)
library(batchelor)
library(ggrepel)
library(dbscan)
library(Rcpp)
library(limma)
library(BiocManager)
library(AnnotationHub)
library(DESeq2)
library(patchwork)
library(miloR)
library(uwot)
library(dplyr)
library(org.Hs.eg.db)
library(EnsDb.Hsapiens.v86)
library(SingleR)
library(ensembldb)
library(Seurat)
library(DESeq2)
library(Matrix.utils)
library(DropletUtils)
library(edgeR)
library(DESeq2)
immune <- sce[,sce$celltype != "Cancer" & sce$celltype != "Cancer_prolif"]
immune <- immune[,immune$sex == "male"]
summed <- aggregateAcrossCells(immune,
id=colData(immune)[,c("Sample","celltype")])
#counts(summed)
#summed$sex
x <- unique(summed$celltype)
## SELECTING CELL TYPE
for (cell in x){
current <- summed[,summed$celltype == cell]
#current$tumor_type
#counts(current)
y <- DGEList(counts(current), samples=colData(current),group=current$tumor_type)
#y$samples
discarded <- current$ncells < 10
y <- y[,!discarded]
#summary(discarded)
keep <- filterByExpr(y, group = current$tumor_type)
y <- y[keep,,keep.lib.sizes=FALSE]
#summary(keep)
y <- calcNormFactors(y)
#y$samples$lib.size
#y$samples
group <- y$samples$group
pca <- prcomp(t(edgeR::cpm(y, normalized.lib.sizes  = TRUE, log = TRUE)))
png(filename = paste(cell,"_PCA_Tumor_Type220111Males.png",sep = ''))
print(ggplot(data.frame(pca$x), aes(PC1, PC2, color = group)) +
geom_point(size = 3) + labs(title = current$celltype, color = 'Tumor Type'))
dev.off()
png(filename = paste(cell,"_PCA_Sample220111Males.png",sep = ''))
print(ggplot(data.frame(pca$x), aes(PC1, PC2, color = y$samples$Sample)) +
geom_point(size = 3) + labs(title = current$celltype, color = 'Sample'))
dev.off()
}
cells <- unique(summed$celltype)
cells
